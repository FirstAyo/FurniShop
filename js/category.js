document.addEventListener("DOMContentLoaded", async () => { const grid = document.getElementById("product-grid"); try { const products = await getProducts(); const list = products.filter(p => p.category === window.CURRENT_CATEGORY); if (!list.length) { grid.innerHTML = "<p class='alert'>No products in this category yet.</p>"; return; } grid.innerHTML = ""; list.forEach(p => { const el = document.createElement("article"); el.className = "card"; el.innerHTML = ` <img src="${p.images[0]}" alt="${p.name}"> <div class="p-16"> <h3><a href="product.html?id=${p.id}">${p.name}</a></h3> <div class="price">${Shop.money(p.price)}</div> <button class="icon-btn" data-id="${p.id}">Add to Cart</button> </div>`; grid.appendChild(el); }); grid.querySelectorAll("button[data-id]").forEach(btn => { btn.addEventListener("click", () => { const p = products.find(x => x.id === Number(btn.dataset.id)); Shop.addToCart({id:p.id, price:p.price, name:p.name, qty:1}); btn.textContent = "Added âœ“"; setTimeout(()=>btn.textContent="Add to Cart", 1000); }); }); } catch (e) { grid.innerHTML = `<div class="alert">${e.message}</div>`; } });