(function() { const themeKey = "theme"; const root = document.documentElement; function applyTheme(val) { if (val === "dark") root.setAttribute("data-theme", "dark"); else if (val === "light") root.setAttribute("data-theme", "light"); else root.removeAttribute("data-theme"); } function loadTheme() { const val = localStorage.getItem(themeKey) || "auto"; applyTheme(val); const btn = document.getElementById("theme-toggle"); if (btn) btn.dataset.mode = val; return val; } function toggleTheme() { const current = localStorage.getItem(themeKey) || "auto"; const next = current === "dark" ? "light" : current === "light" ? "auto" : "dark"; localStorage.setItem(themeKey, next); applyTheme(next); const btn = document.getElementById("theme-toggle"); if (btn) { btn.dataset.mode = next; btn.title = "Theme: " + next; } } function updateCounters() { const cart = JSON.parse(localStorage.getItem("cart") || "[]"); const wish = JSON.parse(localStorage.getItem("wishlist") || "[]"); const cEls = document.querySelectorAll("[data-counter='cart']"); const wEls = document.querySelectorAll("[data-counter='wishlist']"); cEls.forEach(el => el.textContent = cart.reduce((a,i)=>a + (i.qty||1), 0)); wEls.forEach(el => el.textContent = wish.length); } document.addEventListener("DOMContentLoaded", () => { loadTheme(); updateCounters(); const themeBtn = document.getElementById("theme-toggle"); themeBtn && themeBtn.addEventListener("click", toggleTheme); const burger = document.getElementById("hamburger"); const mobileMenu = document.getElementById("mobile-menu"); if (burger && mobileMenu) { burger.addEventListener("click", () => { const open = mobileMenu.classList.toggle("open"); burger.setAttribute("aria-expanded", String(open)); }); } }); window.Shop = { money(n) { return "$" + Number(n).toFixed(2); }, addToCart(item) { const cart = JSON.parse(localStorage.getItem("cart") || "[]"); const found = cart.find(x => x.id === item.id); if (found) found.qty += item.qty || 1; else cart.push({id:item.id, qty:item.qty||1, price:item.price, name:item.name}); localStorage.setItem("cart", JSON.stringify(cart)); const el = document.querySelector("[data-counter='cart']"); if (el) el.textContent = cart.reduce((a,i)=>a + (i.qty||1), 0); }, toggleWishlist(id) { let list = JSON.parse(localStorage.getItem("wishlist") || "[]"); if (list.includes(id)) list = list.filter(x => x!==id); else list.push(id); localStorage.setItem("wishlist", JSON.stringify(list)); const wEls = document.querySelectorAll("[data-counter='wishlist']"); wEls.forEach(el => el.textContent = list.length); return list.includes(id); }, getParam(key) { return new URLSearchParams(location.search).get(key); } }; })();